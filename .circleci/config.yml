version: 2
jobs:
  macbuild:
    macos:
      xcode: "9.0"

    steps:
      - checkout
      - run: /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
      - run: brew install go

      - run:
          name: Install GuPM
          command: curl -fsSL  https://azukaar.github.io/GuPM/install.sh | sudo bash

      - run:
          name: Build
          command: g publish mac
      
      - run: git add docs
      - run: git commit -m "[skip-ci] Mac Release"
      - run: git push origin master

  linuxbuild:
    branches:
      only:

    docker:
      - image: golang:1.12.5-stretch

    steps:
      - checkout

      - run:
          name: Install GuPM
          command: curl -fsSL  https://azukaar.github.io/GuPM/install.sh | sudo bash

      - run:
          name: Build
          command: g publish
      
      - run: git add docs
      - run: git commit -m "[skip-ci] Linux Release"
      - run: git push origin master

workflows:
  version: 2
  build-all:
    jobs:
      - buildmac
      - buildlinux